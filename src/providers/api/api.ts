import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import random from 'random';
import { Observable } from 'rxjs';
import { DefaultProvider } from '../../providers/default/default';

import * as _ from 'lodash';

export interface ChainNetwork {
    chain: string;
    network: string;
}
export interface NetworkSettings {
    availableNetworks: ChainNetwork[];
    selectedNetwork: ChainNetwork;
}

const CurrentEnv = process.env.ENV || 'dev';

const EnvApiHosts: { [env: string]: { [chain: string]: string } } = {
    prod: {
        default: 'https://api.bitcore.io/api',
        ETH: 'https://api-eth.bitcore.io/api'
    },
    dev: { default: '/api' }
};

const CurrentApiHosts = EnvApiHosts[CurrentEnv];

@Injectable()
export class ApiProvider {
    public defaultNetwork = {
        chain: this.defaults.getDefault('%CHAIN%'),
        network: this.defaults.getDefault('%NETWORK%')
    };
    public networkSettings = {
        availableNetworks: [this.defaultNetwork],
        selectedNetwork: this.defaultNetwork,
        chainNetworkLookup: {}
    };

    public ratesAPI = {
        btc: 'https://bitpay.com/api/rates',
        bch: 'https://bitpay.com/api/rates/bch',
        eth: 'https://bitpay.com/api/rates/eth'
    };

    public bwsUrl = {
        urlPrefix: 'https://bws.bitpay.com/bws/api/v1/fiatrates/'
    };

    constructor(
        public httpClient: HttpClient,
        private defaults: DefaultProvider
    ) {

    }

    public getAvailableNetworks(): Observable<
        Array<{ host: string; supported: ChainNetwork[] }>
    > {
        const hosts = CurrentApiHosts;
        return Observable.fromPromise(
            Promise.all(
                Object.keys(hosts).map(async chain => {
                    const host = hosts[chain];
                    const supported = await this.httpClient
                        .get<ChainNetwork[]>(host + '/status/enabled-chains')
                        .toPromise();
                    return {
                        host,
                        supported
                    };
                })
            )
        );
    }

    getHostForChain(chain: string) {
        return CurrentApiHosts[chain] || CurrentApiHosts.default;
    }

    public getUrlPrefix(chain, network): string {
        const defaultChain = chain || this.defaultNetwork.chain;
        const defaultNetwork = network || this.defaultNetwork.network;
        const key = `${defaultChain}:${defaultNetwork}`;
        const lookupHost = this.networkSettings.chainNetworkLookup[key];
        const prefix = lookupHost || this.getHostForChain(chain);
        return prefix;
    }

    public getRandomSapiUrl() {
        const sapis = [
            `167.86.103.167:8080`,
            `51.75.158.4:8080`,
            `218.16.15.25:8080`,
            `218.36.71.59:8080`,
            `121.31.152.240:8080`,
            `218.35.79.66:8080`,
            `222.71.95.191:8080`,
            `195.201.12.93:8080`,
            `173.249.33.239:8080`,
            `167.86.91.147:8080`,
            `51.75.158.25:8080`,
            `167.86.89.56:8080`,
            `144.217.243.36:8080`,
            `94.102.210.157:8080`,
            `135.181.85.180:8080`,
            `135.181.85.177:8080`,
            `135.181.85.186:8080`,
            `135.181.85.188:8080`,
            `135.181.85.176:8080`,
            `135.181.85.183:8080`,
            `135.181.85.184:8080`,
            `135.181.85.187:8080`,
            `135.181.85.182:8080`,
            `135.181.85.185:8080`,
            `195.201.22.100:8080`,
            `195.201.22.122:8080`,
            `195.201.22.110:8080`,
            `195.201.22.103:8080`,
            `195.201.22.112:8080`,
            `195.201.22.113:8080`,
            `195.201.22.117:8080`,
            `195.201.22.101:8080`,
            `195.201.22.107:8080`,
            `195.201.22.116:8080`,
            `95.111.234.235:8080`,
            `173.212.202.54:8080`,
            `218.89.21.12:8080`,
            `216.189.151.100:8080`,
            `167.86.97.16:8080`,
            `167.86.90.125:8080`,
            `218.88.22.15:8080`,
            `167.86.103.116:8080`,
            `46.29.165.15:8080`,
            `111.155.116.200:8080`,
            `167.86.115.21:8080`,
            `173.249.21.162:8080`,
            `173.249.48.174:8080`,
            `167.86.124.227:8080`,
            `45.58.52.239:8080`,
            `207.180.208.104:8080`,
            `167.86.71.171:8080`,
            `164.68.102.153:8080`,
            `37.24.134.95:8080`,
            `164.68.112.229:8080`,
            `88.198.202.140:8080`,
            `213.52.125.41:8080`,
            `173.249.31.63:8080`,
            `45.32.232.116:8080`,
            `199.247.10.156:8080`,
            `167.86.89.3:8080`,
            `164.68.112.231:8080`,
            `45.58.52.245:8080`,
            `178.254.35.44:8080`,
            `167.86.90.211:8080`,
            `167.86.97.20:8080`,
            `173.249.54.29:8080`,
            `207.180.216.182:8080`,
            `173.249.31.45:8080`,
            `167.86.95.13:8080`,
            `51.77.124.25:8080`,
            `195.201.23.4:8080`,
            `195.201.22.241:8080`,
            `164.68.112.225:8080`,
            `167.86.91.99:8080`,
            `178.238.230.37:8080`,
            `167.86.97.15:8080`,
            `207.180.193.156:8080`,
            `51.77.124.10:8080`,
            `178.238.231.201:8080`,
            `71.45.87.12:8080`,
            `167.86.113.143:8080`,
            `167.86.111.184:8080`,
            `202.11.45.21:8080`,
            `89.181.124.117:8080`,
            `95.165.156.202:8080`,
            `207.180.212.131:8080`,
            `180.113.222.218:8080`,
            `217.160.255.46:8080`,
            `167.86.97.6:8080`,
            `159.69.123.196:8080`,
            `113.200.214.164:8080`,
            `80.241.217.151:8080`,
            `207.180.193.28:8080`,
            `167.86.89.12:8080`,
            `164.68.104.4:8080`,
            `167.86.102.234:8080`,
            `173.249.32.39:8080`,
            `216.189.151.203:8080`,
            `164.68.113.173:8080`,
            `167.86.90.127:8080`,
            `51.15.201.249:8080`,
            `164.68.112.213:8080`,
            `144.91.65.38:8080`,
            `167.86.96.209:8080`,
            `207.180.210.221:8080`,
            `167.86.91.163:8080`,
            `167.86.96.251:8080`,
            `167.86.89.49:8080`,
            `5.187.51.206:8080`,
            `167.86.110.12:8080`,
            `89.200.172.119:8080`,
            `207.180.211.41:8080`,
            `157.230.214.214:8080`,
            `46.80.65.33:8080`,
            `173.249.5.205:8080`,
            `5.187.51.231:8080`,
            `95.216.156.245:8080`,
            `94.102.210.123:8080`,
            `216.189.147.222:8080`,
            `85.214.97.248:8080`,
            `167.86.115.17:8080`,
            `167.86.97.5:8080`,
            `162.245.216.8:8080`,
            `162.245.216.209:8080`,
            `207.180.246.171:8080`,
            `167.86.111.183:8080`,
            `45.58.52.246:8080`,
            `207.180.193.2:8080`,
            `46.80.27.152:8080`,
            `167.86.96.249:8080`,
            `167.86.97.12:8080`,
            `167.86.91.157:8080`,
            `167.86.79.45:8080`,
            `213.133.110.230:8080`,
            `167.86.113.142:8080`,
            `218.37.25.44:8080`,
            `168.119.57.54:8080`,
            `168.119.57.49:8080`,
            `168.119.57.48:8080`,
            `168.119.56.7:8080`,
            `168.119.57.50:8080`,
            `168.119.57.36:8080`,
            `168.119.57.42:8080`,
            `168.119.57.43:8080`,
            `168.119.53.99:8080`,
            `168.119.56.51:8080`,
            `135.181.85.190:8080`,
            `135.181.85.192:8080`,
            `135.181.85.198:8080`,
            `135.181.85.191:8080`,
            `135.181.85.196:8080`,
            `161.97.144.8:8080`,
            `216.189.150.254:8080`,
            `45.76.98.254:8080`,
            `54.38.150.123:8080`,
            `125.126.175.165:8080`,
            `213.136.88.211:8080`,
            `167.86.115.199:8080`,
            `222.219.69.74:8080`,
            `173.212.217.82:8080`,
            `167.86.115.104:8080`,
            `80.241.216.205:8080`,
            `216.189.151.173:8080`,
            `95.216.158.51:8080`,
            `93.104.213.141:8080`,
            `167.86.124.244:8080`,
            `70.99.78.22:8080`,
            `167.86.88.223:8080`,
            `46.80.32.45:8080`,
            `167.86.124.247:8080`,
            `45.76.42.67:8080`,
            `167.86.90.132:8080`,
            `5.187.51.215:8080`,
            `167.86.89.39:8080`,
            `51.75.158.7:8080`,
            `45.58.56.64:8080`,
            `173.249.51.154:8080`,
            `61.155.164.111:8080`,
            `216.189.147.82:8080`,
            `173.249.20.101:8080`,
            `167.86.89.31:8080`,
            `79.143.187.62:8080`,
            `212.26.146.137:8080`,
            `51.75.158.99:8080`,
            `172.104.77.31:8080`,
            `218.20.54.163:8080`,
            `164.68.112.224:8080`,
            `173.249.6.78:8080`,
            `113.89.53.140:8080`,
            `167.86.97.22:8080`,
            `88.48.196.218:8080`,
            `62.171.132.115:8080`,
            `173.249.40.165:8080`,
            `45.77.46.20:8080`,
            `46.80.111.10:8080`,
            `167.86.97.14:8080`,
            `216.189.151.94:8080`,
            `167.86.124.235:8080`,
            `167.86.102.231:8080`,
            `167.86.110.24:8080`,
            `195.201.12.90:8080`,
            `88.48.196.118:8080`,
            `45.77.137.15:8080`,
            `135.181.45.39:8080`,
            `167.86.110.26:8080`,
            `168.119.109.36:8080`,
            `216.189.151.138:8080`,
            `46.80.42.39:8080`,
            `167.86.106.244:8080`,
            `51.77.91.2:8080`,
            `167.86.85.149:8080`,
            `216.189.151.184:8080`,
            `104.128.239.48:8080`,
            `85.214.19.239:8080`,
            `51.38.101.174:8080`,
            `167.86.110.20:8080`,
            `216.189.147.95:8080`,
            `164.68.112.233:8080`,
            `167.86.91.129:8080`,
            `95.216.251.180:8080`,
            `164.68.112.222:8080`,
            `207.180.198.130:8080`,
            `167.86.113.138:8080`,
            `94.102.210.119:8080`,
            `173.249.40.106:8080`,
            `167.86.96.252:8080`,
            `167.86.89.239:8080`,
            `51.75.158.6:8080`,
            `49.87.146.144:8080`,
            `167.86.124.239:8080`,
            `164.68.102.163:8080`,
            `135.181.85.207:8080`,
            `135.181.85.202:8080`,
            `135.181.85.205:8080`,
            `135.181.85.208:8080`,
            `135.181.85.209:8080`,
            `135.181.85.201:8080`,
            `135.181.85.200:8080`,
            `135.181.85.206:8080`,
            `195.201.22.221:8080`,
            `195.201.22.200:8080`,
            `195.201.22.207:8080`,
            `195.201.22.227:8080`,
            `195.201.22.213:8080`,
            `195.201.22.216:8080`,
            `195.201.22.205:8080`,
            `195.201.22.210:8080`,
            `195.201.22.201:8080`,
            `195.201.22.214:8080`,
            `168.119.57.83:8080`,
            `168.119.57.82:8080`,
            `168.119.57.72:8080`,
            `168.119.57.81:8080`,
            `168.119.57.77:8080`,
            `168.119.57.73:8080`,
            `168.119.57.70:8080`,
            `60.205.125.201:8080`,
            `218.59.63.22:8080`,
            `207.180.193.27:8080`,
            `167.86.110.13:8080`,
            `80.241.216.188:8080`,
            `164.68.102.157:8080`,
            `213.52.125.44:8080`,
            `88.48.196.18:8080`,
            `54.38.150.124:8080`,
            `94.102.211.12:8080`,
            `151.252.57.205:8080`,
            `80.241.213.200:8080`,
            `164.68.102.152:8080`,
            `173.249.18.2:8080`,
            `45.58.52.235:8080`,
            `167.86.91.104:8080`,
            `167.86.103.113:8080`,
            `167.86.103.117:8080`,
            `207.180.250.179:8080`,
            `167.86.96.250:8080`,
            `167.86.97.11:8080`,
            `218.241.234.48:8080`,
            `167.86.88.172:8080`,
            `202.111.59.34:8080`,
            `207.180.204.151:8080`,
            `164.68.112.219:8080`,
            `95.216.156.21:8080`,
            `218.66.160.212:8080`,
            `164.68.102.155:8080`,
            `202.11.47.22:8080`,
            `173.249.18.163:8080`,
            `173.249.31.227:8080`,
            `167.86.89.176:8080`,
            `173.249.30.122:8080`,
            `151.252.57.206:8080`,
            `167.86.91.152:8080`,
            `167.86.79.4:8080`,
            `167.86.87.55:8080`,
            `167.86.110.28:8080`,
            `218.35.80.67:8080`,
            `173.212.234.230:8080`,
            `167.86.112.51:8080`,
            `218.78.61.25:8080`,
            `207.180.245.37:8080`,
            `207.180.203.197:8080`,
            `51.75.158.19:8080`,
            `216.189.147.174:8080`,
            `104.128.239.52:8080`,
            `153.92.208.64:8080`,
            `95.216.251.181:8080`,
            `68.183.218.85:8080`,
            `164.68.102.151:8080`,
            `62.171.174.157:8080`,
            `164.68.112.227:8080`,
            `164.68.102.167:8080`,
            `167.86.124.234:8080`,
            `54.38.221.35:8080`,
            `167.86.124.246:8080`,
            `207.180.211.50:8080`,
            `202.11.48.23:8080`,
            `218.46.53.27:8080`,
            `95.216.251.183:8080`,
            `207.180.214.74:8080`,
            `167.86.124.242:8080`,
            `216.189.147.45:8080`,
            `193.71.126.42:8080`,
            `207.180.204.80:8080`,
            `135.181.85.199:8080`,
            `135.181.85.197:8080`,
            `135.181.85.194:8080`,
            `135.181.85.195:8080`,
            `135.181.85.193:8080`,
            `195.201.22.153:8080`,
            `195.201.22.163:8080`,
            `195.201.22.187:8080`,
            `195.201.22.192:8080`,
            `195.201.22.135:8080`,
            `195.201.22.154:8080`,
            `195.201.22.170:8080`,
            `195.201.22.178:8080`,
            `195.201.22.189:8080`,
            `195.201.22.132:8080`,
            `135.181.85.203:8080`,
            `135.181.85.204:8080`,
            `178.23.222.2:8080`,
            `202.11.49.24:8080`,
            `207.180.211.40:8080`,
            `202.111.59.57:8080`,
            `213.52.125.42:8080`,
            `45.79.239.226:8080`,
            `104.128.239.55:8080`,
            `167.86.90.143:8080`,
            `207.180.206.21:8080`,
            `167.86.115.207:8080`,
            `167.86.94.162:8080`,
            `164.68.112.228:8080`,
            `207.180.216.178:8080`,
            `167.86.110.19:8080`,
            `51.38.101.175:8080`,
            `167.86.91.153:8080`,
            `164.68.112.218:8080`,
            `173.249.36.55:8080`,
            `167.86.87.59:8080`,
            `207.180.210.172:8080`,
            `167.86.107.226:8080`,
            `51.77.91.4:8080`,
            `174.89.118.143:8080`,
            `94.102.210.158:8080`,
            `168.119.57.76:8080`,
            `168.119.57.78:8080`,
            `168.119.57.75:8080`,
            `135.181.85.212:8080`,
            `135.181.85.159:8080`,
            `135.181.36.193:8080`,
            `135.181.85.149:8080`,
            `95.217.19.237:8080`,
            `95.217.221.28:8080`,
            `95.216.189.91:8080`,
            `135.181.85.150:8080`,
            `135.181.85.171:8080`,
            `173.212.223.176:8080`,
            `95.216.251.182:8080`,
            `164.68.102.148:8080`,
            `164.68.112.220:8080`,
            `167.86.80.36:8080`,
            `136.244.99.10:8080`,
            `207.180.211.144:8080`,
            `167.86.97.7:8080`,
            `167.86.79.34:8080`,
            `216.189.147.248:8080`,
            `167.86.94.165:8080`,
            `51.77.124.7:8080`,
            `173.249.53.47:8080`,
            `173.212.225.161:8080`,
            `218.32.99.72:8080`,
            `124.187.44.212:8080`,
            `164.68.98.161:8080`,
            `167.86.91.140:8080`,
            `218.18.86.43:8080`,
            `216.189.150.163:8080`,
            `167.86.88.222:8080`,
            `167.86.91.133:8080`,
            `14.117.177.103:8080`,
            `167.86.93.226:8080`,
            `167.86.97.10:8080`,
            `167.86.97.27:8080`,
            `95.179.190.8:8080`,
            `217.69.5.79:8080`,
            `167.86.90.167:8080`,
            `173.249.49.54:8080`,
            `167.86.90.110:8080`,
            `167.86.90.25:8080`,
            `167.86.124.241:8080`,
            `207.180.229.173:8080`,
            `173.249.27.254:8080`,
            `167.86.93.186:8080`,
            `180.115.1.87:8080`,
            `202.11.55.27:8080`,
            `167.86.93.203:8080`,
            `167.86.123.246:8080`,
            `89.200.172.159:8080`,
            `173.249.15.183:8080`,
            `212.227.211.87:8080`,
            `202.11.56.28:8080`,
            `45.80.152.12:8080`,
            `88.48.196.108:8080`,
            `207.180.204.56:8080`,
            `167.86.90.46:8080`,
            `139.180.161.117:8080`,
            `173.249.27.22:8080`,
            `218.98.33.24:8080`,
            `167.86.96.253:8080`,
            `216.189.147.65:8080`,
            `202.111.59.29:8080`,
            `218.13.11.186:8080`,
            `27.46.42.250:8080`,
            `95.179.255.254:8080`,
            `173.212.195.229:8080`,
            `173.249.13.18:8080`,
            `172.105.60.87:8080`,
            `68.183.165.70:8080`,
            `188.166.121.129:8080`,
            `51.77.124.12:8080`,
            `167.86.124.236:8080`,
            `46.80.51.86:8080`,
            `218.68.86.47:8080`,
            `95.217.215.17:8080`,
            `195.201.23.0:8080`,
            `195.201.22.255:8080`,
            `195.201.22.238:8080`,
            `195.201.22.96:8080`,
            `195.201.23.2:8080`,
            `195.201.22.249:8080`,
            `195.201.22.233:8080`,
            `195.201.22.254:8080`,
            `167.86.79.59:8080`,
            `167.86.85.248:8080`,
            `207.180.216.124:8080`,
            `164.68.102.156:8080`,
            `167.86.97.24:8080`,
            `207.180.206.97:8080`,
            `207.180.246.218:8080`,
            `207.180.212.197:8080`,
            `173.249.31.145:8080`,
            `71.45.53.64:8080`,
            `167.86.90.75:8080`,
            `167.86.124.251:8080`,
            `54.38.150.119:8080`,
            `95.217.14.17:8080`,
            `51.38.101.173:8080`,
            `78.193.207.8:8080`,
            `207.180.207.146:8080`,
            `104.128.226.40:8080`,
            `51.77.124.18:8080`,
            `164.68.102.166:8080`,
            `213.52.125.43:8080`,
            `45.76.34.140:8080`,
            `207.180.202.230:8080`,
            `62.171.163.23:8080`,
            `51.75.158.103:8080`,
            `167.86.88.157:8080`,
            `193.126.149.139:8080`,
            `207.180.200.239:8080`,
            `173.249.51.210:8080`,
            `45.32.126.230:8080`,
            `51.75.158.111:8080`,
            `164.68.99.213:8080`,
            `121.31.150.110:8080`,
            `78.60.219.169:8080`,
            `173.249.16.58:8080`,
            `164.68.112.216:8080`,
            `207.180.210.63:8080`,
            `173.249.12.82:8080`,
            `167.86.124.228:8080`,
            `164.68.112.215:8080`,
            `167.86.91.98:8080`,
            `167.86.124.248:8080`,
            `46.80.142.28:8080`,
            `173.249.24.50:8080`,
            `202.111.66.166:8080`,
            `218.47.23.55:8080`,
            `51.77.124.22:8080`,
            `173.212.252.120:8080`,
            `207.180.234.61:8080`,
            `207.180.202.120:8080`,
            `167.86.91.12:8080`,
            `51.75.158.23:8080`,
            `173.249.15.238:8080`,
            `167.86.89.215:8080`,
            `167.86.124.249:8080`,
            `207.180.218.18:8080`,
            `167.86.107.224:8080`,
            `167.86.89.6:8080`,
            `173.249.21.154:8080`,
            `138.201.247.198:8080`,
            `218.80.79.55:8080`,
            `173.249.60.78:8080`,
            `218.53.33.24:8080`,
            `144.91.78.28:8080`,
            `173.249.54.4:8080`,
            `5.187.51.212:8080`,
            `209.250.224.212:8080`,
            `167.86.103.114:8080`,
            `218.88.21.55:8080`,
            `45.58.52.250:8080`,
            `216.189.151.207:8080`,
            `70.52.79.114:8080`,
            `164.68.102.149:8080`,
            `164.68.102.158:8080`,
            `164.68.102.162:8080`,
            `173.249.23.24:8080`,
            `46.80.171.215:8080`,
            `46.80.29.78:8080`,
            `167.86.88.137:8080`,
            `95.111.235.137:8080`,
            `218.86.68.23:8080`,
            `167.86.85.147:8080`,
            `167.86.110.23:8080`,
            `51.210.243.4:8080`,
            `173.212.211.55:8080`,
            `167.86.90.88:8080`,
            `167.86.107.227:8080`,
            `207.180.227.207:8080`,
            `207.180.200.237:8080`,
            `79.143.181.118:8080`,
            `88.48.196.128:8080`,
            `167.86.87.54:8080`,
            `173.249.14.78:8080`,
            `173.249.46.109:8080`,
            `218.78.131.22:8080`,
            `109.87.231.183:8080`,
            `51.38.101.172:8080`,
            `173.249.11.196:8080`,
            `167.86.112.151:8080`,
            `164.68.113.171:8080`,
            `51.77.227.47:8080`,
            `167.86.88.253:8080`,
            `164.68.112.234:8080`,
            `151.252.57.207:8080`,
            `195.201.3.145:8080`,
            `104.128.239.212:8080`,
            `93.188.165.193:8080`,
            `144.91.65.235:8080`,
            `45.32.183.71:8080`,
            `207.180.212.152:8080`,
            `167.86.88.160:8080`,
            `202.111.59.68:8080`,
            `173.212.202.225:8080`,
            `167.86.124.232:8080`,
            `151.252.57.204:8080`,
            `51.77.124.2:8080`,
            `167.86.91.2:8080`,
            `172.104.36.13:8080`,
            `167.86.96.5:8080`,
            `151.252.57.208:8080`,
            `173.249.23.185:8080`,
            `46.80.64.82:8080`,
            `51.77.227.30:8080`,
            `14.161.22.94:8080`,
            `54.38.221.37:8080`,
            `167.86.97.21:8080`,
            `182.88.128.64:8080`,
            `80.241.213.83:8080`,
            `173.249.18.165:8080`,
            `104.128.226.72:8080`,
            `207.180.228.119:8080`,
            `164.68.99.241:8080`,
            `45.58.52.230:8080`,
            `164.68.102.154:8080`,
            `165.227.173.131:8080`
        ];
        if (window.location.protocol === 'http:') {
            let electedSapi = sapis[random.int(0, sapis.length - 1)];
            let prefix = `http://${electedSapi}/v1/`;
            return prefix;
        }
        return `https://sapi.smartcash.cc/v1/`;
    }

    public getUrl(params?: { chain?: string; network?: string }): string {
        let { chain, network } = params;
        chain = chain || this.networkSettings.selectedNetwork.chain;
        network = network || this.networkSettings.selectedNetwork.network;
        const prefix: string = this.getUrlPrefix(chain, network);
        const apiPrefix = `${prefix}/${chain}/${network}`;
        return apiPrefix;
    }

    public getConfig(): ChainNetwork {
        const config = {
            chain: this.networkSettings.selectedNetwork.chain,
            network: this.networkSettings.selectedNetwork.network
        };
        return config;
    }

    public changeNetwork(network: ChainNetwork): void {
        const availableNetworks = this.networkSettings.availableNetworks;
        // Can't do the following because availableNetworks is loaded
        /*
         *const isValid = _.some(availableNetworks, network);
         *if (!isValid) {
         *  this.logger.error(
         *    'Invalid URL: missing or invalid COIN or NETWORK param'
         *  );
         *  return;
         *}
         */
        this.networkSettings = {
            availableNetworks,
            selectedNetwork: network,
            chainNetworkLookup: this.networkSettings.chainNetworkLookup || {}
        };
    }
}
